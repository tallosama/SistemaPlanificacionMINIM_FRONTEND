<nb-card class="col-md-12 col-lg-12 col-xxxl-12">
  <nb-card-body>
    <nb-stepper #stepper orientation="horizontal">
      <nb-step [label]="labelOne">
        <ng-template #labelOne>Paso #1</ng-template>
        <h3>#1 Selección del personal</h3>

        <div class="col-md-8 mx-auto">
          <!--                              Con pipe async
          <ng-autocomplete [data]="areas$ | async" [searchKeyword]="keyword" [itemTemplate]="itemTemplate"
            [notFoundTemplate]="notFoundTemplate" placeholder="Ingrese el área" (selected)='reconstruir($event)'>
          </ng-autocomplete> -->

          <ng-autocomplete
            [data]="areas"
            [searchKeyword]="keyword"
            [itemTemplate]="itemTemplate"
            [notFoundTemplate]="notFoundTemplate"
            placeholder="Ingrese el área"
            (selected)="reconstruir($event)"
            notFoundText="No se encontró"
            historyIdentifier="ListaAreaReciente"
            [historyHeading]="historyHeading"
            historyListMaxNumber="3"
          >
          </ng-autocomplete>

          <ng-template #itemTemplate let-item>
            <a [innerHTML]="item.desArea"></a>
          </ng-template>

          <ng-template #notFoundTemplate let-notFound>
            <div [innerHTML]="notFound"></div>
          </ng-template>
        </div>

        <nb-card-body>
          <ng2-smart-table
            [settings]="settings"
            [source]="sourceSmartUsuario"
            (edit)="validarPersona($event)"
          >
          </ng2-smart-table>
          <!--     <div class="table-responsive">
          
           <table datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger">
              <thead class="thead-dark">
                <tr>
                  <th scope="col">Cédula</th>
                  <th scope="col">Primer nombre</th>
                  <th scope="col">Segundo nombre</th>
                  <th scope="col">Primer apellido</th>
                  <th scope="col">Segundo apellido</th>
                  <th scope="col">Tipo</th>
                  <th scope="col">Estado</th>
                  <th scope="col">Asignar usuario</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let p of data">
                  <td>{{ p.cedula }}</td>
                  <td>{{ p.pNombre }}</td>
                  <td>{{ p.sNombre }}</td>
                  <td>{{ p.pApellido }}</td>
                  <td>{{ p.sApellido }}</td>
                  <td>{{ p.tipo }}</td>
                  <td>{{ p.estado ? "Activo" : "Inactivo" }}</td>
                  <td>
                    <div *ngIf="p.estado">
                      <button
                        class="btn btn-primary"
                        nbStepperNext
                        (click)="asignarPersona(p)"
                      >
                        <i class="nb-compose"></i>
                      </button>
                    </div>

                    <div *ngIf="p.estado == false">
                      <button
                        class="btn btn-primary"
                        (click)="validarPersona(p)"
                      >
                        <i class="nb-compose"></i>
                      </button>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div> -->
        </nb-card-body>
      </nb-step>

      <nb-step [label]="labelTwo">
        <ng-template #labelTwo>Paso #2</ng-template>
        <h3>#2 Registrar</h3>

        <form [formGroup]="usuarioForm" *ngIf="usuarioForm">
          <div class="row">
            <div class="col-md-6">
              <div class="form-group">
                <label class="label">Correo</label>

                <input
                  nbInput
                  fullWidth
                  shape="round"
                  formControlName="Correo"
                  placeholder="Correo"
                  pattern=".+@.+\..+"
                  fieldSize="large"
                />
                <div
                  *ngIf="
                    usuarioForm.get('Correo').invalid &&
                    usuarioForm.get('Correo').touched
                  "
                >
                  <p
                    class="caption status-danger"
                    *ngIf="usuarioForm.get('Correo').errors?.required"
                  >
                    El correo es requerido
                  </p>

                  <p
                    class="caption status-danger"
                    *ngIf="
                      usuarioForm.get('Correo').errors?.email &&
                      usuarioForm.get('Correo').errors?.pattern
                    "
                  >
                    Debe ingresar un correo real
                  </p>

                  <p
                    class="caption status-danger"
                    *ngIf="usuarioForm.get('Correo').hasError('maxlength')"
                  >
                    Debe ingresar un correo menor a 32 carácteres
                  </p>
                </div>
              </div>
            </div>

            <div class="col-md-6">
              <div class="form-group">
                <label class="label">Clave</label>
                <input
                  type="text"
                  formControlName="Clave"
                  nbInput
                  fullWidth
                  shape="round"
                />
                <div
                  *ngIf="
                    usuarioForm.get('Clave').invalid &&
                    usuarioForm.get('Clave').touched
                  "
                >
                  <p
                    class="caption status-danger"
                    *ngIf="usuarioForm.get('Clave').hasError('required')"
                  >
                    La clave es obligatoria
                  </p>

                  <p
                    class="caption status-danger"
                    *ngIf="usuarioForm.get('Clave').hasError('maxlength')"
                  >
                    Debe ingresar una clave menor a 128 carácteres
                  </p>
                </div>

                <button class="btn btn-primary" (click)="generarClave()">
                  Generar
                </button>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-md-6">
              <div class="form-group">
                <label class="label">Estado</label>

                <nb-select formControlName="Estado">
                  <nb-option *ngFor="let e of estado" [value]="e.Estado">
                    {{ e.Descripcion }}
                  </nb-option>
                </nb-select>
              </div>
            </div>

            <div class="col-md-6">
              <div class="form-group">
                <label class="label">Rol</label>
                <nb-select formControlName="Rol">
                  <nb-option value="">Seleccione</nb-option>
                  <nb-option *ngFor="let r of roles" [value]="r.desRol">{{
                    r.desRol
                  }}</nb-option>
                </nb-select>
              </div>
            </div>
          </div>

          <button
            id="b1"
            class="b1"
            type="submit"
            [disabled]="usuarioForm.invalid"
            nbButton
            status="primary"
            (click)="guardar()"
          >
            Guardar
          </button>
        </form>

        <button nbButton nbStepperPrevious>Atrás</button>
        <!--<button nbButton disabled nbStepperNext>Siguiente</button> -->
      </nb-step>
    </nb-stepper>
  </nb-card-body>
</nb-card>
